---
import ProviderLayout from "../../layouts/ProviderLayout.astro";
import OperationsTable from "../../components/OperationsTable.astro";
import OperationDetails from "../../components/OperationDetails.astro";
import CodeBlock from "../../components/CodeBlock.astro";
import { getOperationsForProvider } from "../../data/operations.js";

const operations = getOperationsForProvider("Ef");

const setupCode = `// Define the EF tool (installs if needed)
var EfTool = Dotnet.Tool("dotnet-ef", "9.0.0");`;

const exampleCode = `// Define the DbContext reference
var DataProject = Dotnet.Project("./src/Data/Data.csproj");
var db = Ef.DbContextFrom(DataProject, "AppDbContext");

// Apply migrations to the database
Ef.DatabaseUpdate(db);

// Or generate an idempotent SQL script
Ef.Script(db, Root / "artifacts" / "migration.sql");`;
---

<ProviderLayout
  title="EF Core"
  provider="EF Core"
  description="Manage Entity Framework Core migrations and database updates."
>
  <section id="operations" class="mb-8">
    <h2 class="mb-3 text-xl font-bold text-zinc-900 dark:text-white">Operations</h2>
    <OperationsTable operations={operations} />
  </section>

  <section id="details" class="mb-8">
    <h2 class="mb-6 text-xl font-bold text-zinc-900 dark:text-white">Operation Details</h2>
    <OperationDetails operations={operations} />
  </section>

  <section id="setup" class="mb-8">
    <h2 class="mb-3 text-xl font-bold text-zinc-900 dark:text-white">Setup</h2>
    <p class="mb-4 text-zinc-500 dark:text-zinc-400">
      EF Core operations require the <code
        class="rounded border border-zinc-200 bg-zinc-100 px-1.5 text-sm dark:border-zinc-700 dark:bg-zinc-800"
        >dotnet-ef</code
      > tool. ANDO can install it automatically.
    </p>
    <CodeBlock code={setupCode} lang="csharp" filename="build.csando" />
  </section>

  <section id="example" class="mb-8">
    <h2 class="mb-3 text-xl font-bold text-zinc-900 dark:text-white">Example</h2>
    <p class="mb-4 text-zinc-500 dark:text-zinc-400">Run migrations and generate SQL scripts.</p>
    <CodeBlock code={exampleCode} lang="csharp" filename="build.csando" />
  </section>
</ProviderLayout>
