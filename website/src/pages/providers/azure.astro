---
import ProviderLayout from "../../layouts/ProviderLayout.astro";
import OperationsTable from "../../components/OperationsTable.astro";
import OperationDetails from "../../components/OperationDetails.astro";
import { getOperationsForProvider } from "../../data/operations.js";

const operations = getOperationsForProvider("Azure");
---

<ProviderLayout
  title="Azure"
  provider="Azure"
  description="Manage Azure resources and authentication using the Azure CLI."
>
  <section id="operations" class="mb-8">
    <h2 class="mb-3 text-xl font-bold text-zinc-900 dark:text-white">Operations</h2>
    <OperationsTable operations={operations} />
  </section>

  <section id="details" class="mb-8">
    <h2 class="mb-6 text-xl font-bold text-zinc-900 dark:text-white">Operation Details</h2>
    <OperationDetails operations={operations} />
  </section>

  <section id="authentication" class="mb-8">
    <h2 class="mb-3 text-xl font-bold text-zinc-900 dark:text-white">Authentication</h2>
    <p class="mb-4 text-zinc-500 dark:text-zinc-400">
      Azure operations require authentication via the Azure CLI. Choose the method that fits your environment.
    </p>

    <h3 class="mt-6 mb-3 text-base font-semibold text-zinc-900 dark:text-white">
      Environment Variables (Service Principal)
    </h3>
    <table class="my-3 w-full text-sm">
      <thead>
        <tr class="border-b border-zinc-200 dark:border-zinc-700">
          <th class="px-3 py-3 text-left text-xs font-semibold tracking-wider text-zinc-400 uppercase">Variable</th>
          <th class="px-3 py-3 text-left text-xs font-semibold tracking-wider text-zinc-400 uppercase">Description</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-b border-zinc-100 hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-800/50">
          <td class="px-3 py-3"><code class="text-cyan-600 dark:text-cyan-400">AZURE_CLIENT_ID</code></td>
          <td class="px-3 py-3 text-zinc-600 dark:text-zinc-400">Service principal application ID</td>
        </tr>
        <tr class="border-b border-zinc-100 hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-800/50">
          <td class="px-3 py-3"><code class="text-cyan-600 dark:text-cyan-400">AZURE_CLIENT_SECRET</code></td>
          <td class="px-3 py-3 text-zinc-600 dark:text-zinc-400">Service principal secret</td>
        </tr>
        <tr class="border-b border-zinc-100 hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-800/50">
          <td class="px-3 py-3"><code class="text-cyan-600 dark:text-cyan-400">AZURE_TENANT_ID</code></td>
          <td class="px-3 py-3 text-zinc-600 dark:text-zinc-400">Azure AD tenant ID</td>
        </tr>
        <tr class="border-b border-zinc-100 hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-800/50">
          <td class="px-3 py-3"><code class="text-cyan-600 dark:text-cyan-400">AZURE_SUBSCRIPTION_ID</code></td>
          <td class="px-3 py-3 text-zinc-600 dark:text-zinc-400">Target subscription ID</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="example" class="mb-8">
    <h2 class="mb-3 text-xl font-bold text-zinc-900 dark:text-white">Example</h2>
    <p class="mb-4 text-zinc-500 dark:text-zinc-400">Authenticate and create a resource group.</p>
    <div
      class="relative overflow-x-auto rounded-xl border border-zinc-800 bg-zinc-900 p-4 font-mono text-sm leading-relaxed"
    >
      <span class="absolute top-3 right-4 text-xs tracking-wider text-zinc-400 uppercase">build.csando</span>
      <pre
        class="m-0 whitespace-pre"><code class="text-zinc-200"><span class="text-slate-400 italic">// For CI/CD: login with service principal</span>
<span class="text-sky-200">Azure</span>.<span class="text-violet-300">LoginWithServicePrincipal</span>();
<span class="text-sky-200">Azure</span>.<span class="text-violet-300">SetSubscription</span>();

<span class="text-slate-400 italic">// For local dev: ensure already logged in</span>
<span class="text-sky-200">Azure</span>.<span class="text-violet-300">EnsureLoggedIn</span>();

<span class="text-slate-400 italic">// Create resource group</span>
<span class="text-sky-200">Azure</span>.<span class="text-violet-300">CreateResourceGroup</span>(<span class="text-green-300">"my-app-rg"</span>, <span class="text-green-300">"eastus"</span>);</code></pre>
    </div>
  </section>
</ProviderLayout>
